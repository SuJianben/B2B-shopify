{% comment %} sections/footer-vue.liquid {% endcomment %}

{% capture footer_data %}
{
  "columns": [
    {% for block in section.blocks %}
      {
        "id": "{{ block.id }}",
        "type": "{{ block.type }}",
        "settings": {
          {% case block.type %}
            
            {% when 'brand_block' %}
              "logo": "{% if block.settings.logo %}{{ block.settings.logo | image_url: width: 300 }}{% endif %}",
              "logo_width": {{ block.settings.logo_width | default: 180 }},
              "mobile_logo_width": {{ block.settings.mobile_logo_width | default: 180 }},
              "description": {{ block.settings.description | json }},
              "show_social": {{ block.settings.show_social | json }},
              "social_links": {
                "facebook": "{{ settings.social_facebook_link }}",
                "twitter": "{{ settings.social_twitter_link }}",
                "instagram": "{{ settings.social_instagram_link }}"
              }

            {% when 'menu_block' %}
              "title": {{ block.settings.title | json }},
              "links": [
                {% for link in linklists[block.settings.menu].links %}
                  { "text": {{ link.title | json }}, "url": "{{ link.url }}" }{% unless forloop.last %},{% endunless %}
                {% endfor %}
              ]

            {% when 'info_block' %}
              "title": {{ block.settings.title | json }},
              "address": {{ block.settings.address | json }},
              "phone": {{ block.settings.phone | json }},
              "email": {{ block.settings.email | json }}

          {% endcase %}
        }
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
{% endcapture %}

<div id="vue-footer-root" data-settings='{{ footer_data | escape }}'></div>

{% schema %}
{
  "name": "Vue Footer Modular",
  "max_blocks": 5,
  "settings": [
     { "type": "header", "content": "Layout is controlled by Blocks" }
  ],
  "blocks": [
    {
      "type": "brand_block",
      "name": "Brand / Logo",
      "limit": 1,
      "settings": [
        { "type": "image_picker", "id": "logo", "label": "Logo Image" },
        { "type": "range", "id": "logo_width", "label": "PC Logo Width", "min": 0, "max": 300, "step": 5, "unit": "px", "default": 180 },
        { "type": "range", "id": "mobile_logo_width", "label": "Mobile Logo Width", "min": 0, "max": 300, "step": 5, "unit": "px", "default": 180 },
        { "type": "textarea", "id": "description", "label": "Description", "default": "Your brand story here." },
        { "type": "checkbox", "id": "show_social", "label": "Show Social Icons", "default": true }
      ]
    },
    {
      "type": "menu_block",
      "name": "Menu Column",
      "settings": [
        { "type": "text", "id": "title", "label": "Heading", "default": "Quick Links" },
        { "type": "link_list", "id": "menu", "label": "Select Menu" }
      ]
    },
    {
      "type": "info_block",
      "name": "Store Info",
      "limit": 1,
      "settings": [
        { "type": "text", "id": "title", "label": "Heading", "default": "Store Information" },
        { "type": "text", "id": "address", "label": "Address", "default": "Guangzhou City" },
        { "type": "text", "id": "phone", "label": "Phone", "default": "020-88888888" },
        { "type": "text", "id": "email", "label": "Email", "default": "contact@example.com" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Vue Footer Modular",
      "blocks": [
        { "type": "brand_block" },
        { "type": "menu_block" },
        { "type": "menu_block" },
        { "type": "info_block" }
      ]
    }
  ]
}
{% endschema %}